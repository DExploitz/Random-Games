local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")
local plr = Players.LocalPlayer
local folder = workspace:WaitForChild("chests")

local enabled = false
local running = true
local delayTime = 0.2
local hrp

-- handle character respawn
local function updateChar()
	local char = plr.Character or plr.CharacterAdded:Wait()
	hrp = char:WaitForChild("HumanoidRootPart", 5)
end
updateChar()
plr.CharacterAdded:Connect(updateChar)

-- UI
local gui = Instance.new("ScreenGui", plr:WaitForChild("PlayerGui"))
gui.ResetOnSpawn = false

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0.2, 0, 0.2, 0)
frame.Position = UDim2.new(0.4, 0, 0.4, 0)
frame.BackgroundColor3 = Color3.fromRGB(45,45,45)
frame.Active = true
frame.Draggable = true

local dragBar = Instance.new("Frame", frame)
dragBar.Size = UDim2.new(1,0,0.2,0)
dragBar.BackgroundColor3 = Color3.fromRGB(30,30,30)
dragBar.BorderSizePixel = 0

local credit = Instance.new("TextLabel", dragBar)
credit.Size = UDim2.new(1,0,1,0)
credit.BackgroundTransparency = 1
credit.Text = "By : @dexploitz on YT"
credit.TextColor3 = Color3.new(1,1,1)
credit.TextStrokeTransparency = 0
credit.Font = Enum.Font.SourceSansBold
credit.TextScaled = true

local toggle = Instance.new("TextButton", frame)
toggle.Size = UDim2.new(1, -0.1, 0.2, 0)
toggle.Position = UDim2.new(0.05, 0, 0.25, 0)
toggle.BackgroundColor3 = Color3.fromRGB(60,60,60)
toggle.TextColor3 = Color3.new(1,1,1)
toggle.Font = Enum.Font.SourceSansBold
toggle.TextSize = 18
toggle.Text = "Enable Auto Open"

local delayBox = Instance.new("TextBox", frame)
delayBox.Size = UDim2.new(1, -0.1, 0.2, 0)
delayBox.Position = UDim2.new(0.05, 0, 0.5, 0)
delayBox.BackgroundColor3 = Color3.fromRGB(50,50,50)
delayBox.TextColor3 = Color3.new(1,1,1)
delayBox.Font = Enum.Font.SourceSans
delayBox.TextSize = 16
delayBox.PlaceholderText = "Delay (sec)..."
delayBox.Text = tostring(delayTime)

local destroy = Instance.new("TextButton", frame)
destroy.Size = UDim2.new(1, -0.1, 0.2, 0)
destroy.Position = UDim2.new(0.05, 0, 0.75, 0)
destroy.BackgroundColor3 = Color3.fromRGB(80,0,0)
destroy.TextColor3 = Color3.new(1,1,1)
destroy.Font = Enum.Font.SourceSansBold
destroy.TextSize = 16
destroy.Text = "Destroy UI"

toggle.MouseButton1Click:Connect(function()
	enabled = not enabled
	toggle.Text = enabled and "Disable Auto Open" or "Enable Auto Open"
end)

delayBox.FocusLost:Connect(function()
	local v = tonumber(delayBox.Text)
	if v and v >= 0 then delayTime = v else delayBox.Text = tostring(delayTime) end
end)

destroy.MouseButton1Click:Connect(function()
	running = false
	gui:Destroy()
end)

task.spawn(function()
	while running do
		if enabled and hrp and hrp.Parent then
			for _, chest in ipairs(folder:GetChildren()) do
				if not running or not enabled then break end
				if chest.Name:lower():match("chest$") then
					local p = chest:FindFirstChildWhichIsA("ProximityPrompt")
					if p then
						pcall(function() hrp.CFrame = chest.CFrame end)
						task.wait(0.15)
						fireproximityprompt(p)
						task.wait(delayTime)
					end
				end
			end
		else
			task.wait(0.5)
		end
	end
end)

-- proper notification with BindableEvent callback :contentReference[oaicite:6]{index=6}
local bind = Instance.new("BindableEvent")
bind.Event:Connect(function(choice)
	if choice == "Yes" then
		pcall(function() toclipboard("https://discord.gg/T7NjmUgZcm") end)
		StarterGui:SetCore("SendNotification", {
			Title = "Copied!";
			Text = "Copied discord invite link! Paste it in your browser";
			Duration = 5;
		})
	end
end)

StarterGui:SetCore("SendNotification", {
	Title = "Thanks for using my script!";
	Text = "Join my discord server please";
	Duration = 8;
	Button1 = "Yes";
	Button2 = "No";
	Callback = bind;
})
